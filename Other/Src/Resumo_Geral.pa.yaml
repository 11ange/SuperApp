# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  Resumo_Geral:
    Properties:
      Fill: =RGBA(232, 232, 232, 1)
      LoadingSpinnerColor: =RGBA(0, 51, 102, 1)
      OnVisible: =true
    Children:
      - RectQuickActionBar3_10:
          Control: Rectangle@2.3.0
          Properties:
            BorderColor: =RGBA(0, 89, 178, 1)
            Fill: =RGBA(0, 51, 102, 1)
            Height: =88
            Width: =Parent.Width
      - Icone_Cancela_Controle_2:
          Control: Classic/Icon@2.5.0
          Properties:
            AccessibleLabel: =Self.Tooltip
            BorderColor: =RGBA(0, 89, 178, 1)
            Color: =RGBA(255, 255, 255, 1)
            Height: =88
            Icon: =Icon.CancelBadge
            OnSelect: =Back()
            PaddingBottom: =22
            PaddingLeft: =22
            PaddingRight: =22
            PaddingTop: =22
            PressedFill: =RGBA(255, 255, 255, 0.3)
            TabIndex: =0
            Tooltip: ="Cancel item"
            Width: =88
      - LblAppName3_5:
          Control: Label@2.5.1
          Properties:
            BorderColor: =RGBA(0, 0, 0, 1)
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(58, 58, 58, 0)
            Font: =Font.'Open Sans'
            Height: =88
            Size: =27
            Text: ="Resumo Geral"
            Width: =Parent.Width - Icone_Cancela_Controle_2.Width
            Wrap: =false
            X: =80
      - HTML_Assistencias_1:
          Control: HtmlViewer@2.1.0
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Font: =Font.'Open Sans'
            Height: =50
            HtmlText: |-
              =//"Exiba seu texto <b><font color=blue>HTML</font></b> aqui."
              "Assistências em aberto: <b>" & Assistencias
            Width: =450
            X: =95
            Y: =200
      - HTML_Aguardando_Dialogo_1:
          Control: HtmlViewer@2.1.0
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Font: =Font.'Open Sans'
            Height: =50
            HtmlText: |-
              =//"Exiba seu texto <b><font color=blue>HTML</font></b> aqui."
              "Aguardando diálogo: <b>" & AguardandoDialogos
            Width: =450
            X: =98
            Y: =650
      - Dropdown_Dia_Semana:
          Control: Classic/DropDown@2.3.1
          Properties:
            BorderColor: =RGBA(0, 89, 178, 1)
            ChevronBackground: =RGBA(0, 51, 102, 1)
            ChevronFill: =RGBA(255, 255, 255, 1)
            ChevronHoverBackground: =ColorFade(RGBA(0, 51, 102, 1), -20%)
            ChevronHoverFill: =RGBA(255, 255, 255, 1)
            Font: =Font.'Open Sans'
            Height: =50
            HoverFill: =RGBA(153, 205, 255, 1)
            Items: =DiasAssistência
            Items.Value: =Value
            OnChange: |
              =ClearCollect(
                  ColecaoAssistenciasFiltradas,
                  Filter(
                      Assistências,
                      'Dia Semana' = Dropdown_Dia_Semana.Selected.Value
                  )
              );
              Set(Assistencias, CountIf(ColecaoAssistenciasFiltradas, true));
              //------
              Clear(ColecaoAssistenciasFiltradas);

              ClearCollect(
                  ColecaoAssistenciasFiltradas,
                  Filter(
                      Assistências,
                      Finalizada = "Sim",
                      'Dia Semana' = Dropdown_Dia_Semana.Selected.Value
                  )
              );
              Set(AguardandoDialogos, CountIf(ColecaoAssistenciasFiltradas, true));
              //------
              Clear(ColecaoAssistenciasFiltradas);

              ClearCollect(
                  ColecaoAssistenciasFiltradas,
                  Filter(
                      Assistências,
                      IsBlank('Semana 1'),
                      'Dia Semana' = Dropdown_Dia_Semana.Selected.Value
                  )
              );
              Set(SoEntrevista, CountIf(ColecaoAssistenciasFiltradas, true));
              //------
              Clear(ColecaoAssistenciasFiltradas);

              ClearCollect(
                  ColecaoAssistenciasFiltradas,
                  Filter(
                      Assistências,
                      'Dia Semana' = Dropdown_Dia_Semana.Selected.Value
                  )
              );

              ClearCollect(
                  ColecaoAssistenciasFinal,
                  Filter(
                      ColecaoAssistenciasFiltradas,
                      IsBlank('Semana 2') &&
                      IsBlank('Semana 3') &&
                      IsBlank('Semana 4') &&
                      DateDiff('Semana 1', Now()) > tolerancia * 7
                  )
              );
              Set(So1aSemana, CountIf(ColecaoAssistenciasFiltradas, true));
              //------
              Clear(ColecaoAssistenciasFiltradas);

              ClearCollect(
                  ColecaoAssistenciasFiltradas,
                  Filter(
                      Assistências,
                      'Dia Semana' = Dropdown_Dia_Semana.Selected.Value
                  )
              );

              ClearCollect(
                  ColecaoAssistenciasFinal,
                  Filter(
                      ColecaoAssistenciasFiltradas,
                      IsBlank('Semana 3') &&
                      IsBlank('Semana 4') &&
                      DateDiff('Semana 2', Now()) > tolerancia * 7
                  )
              );
              Set(So2aSemana, CountIf(ColecaoAssistenciasFiltradas, true));
              //------
              Clear(ColecaoAssistenciasFiltradas);

              ClearCollect(
                  ColecaoAssistenciasFiltradas,
                  Filter(
                      Assistências,
                      'Dia Semana' = Dropdown_Dia_Semana.Selected.Value
                  )
              );

              ClearCollect(
                  ColecaoAssistenciasFinal,
                  Filter(
                      ColecaoAssistenciasFiltradas,
                      IsBlank('Semana 4') &&
                      DateDiff('Semana 3', Now()) > tolerancia * 7
                  )
              );
              Set(So3aSemana, CountIf(ColecaoAssistenciasFiltradas, true));
              //------

              Set(ForaPrazo,
                  SoEntrevista + So1aSemana + So2aSemana + So3aSemana
              );
              //------

              Set(DentroPrazo,
                  Assistencias - ForaPrazo
              );
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(0, 89, 178, 1)
            SelectionColor: =RGBA(255, 255, 255, 1)
            SelectionFill: =RGBA(0, 51, 102, 1)
            Width: =300
            X: =170
            Y: =121
      - HTML_Aguardando_Dialogo_2:
          Control: HtmlViewer@2.1.0
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Font: =Font.'Open Sans'
            Height: =50
            HtmlText: |-
              =//"Exiba seu texto <b><font color=blue>HTML</font></b> aqui."
              "Dentro do prazo: <b>" & DentroPrazo
            Width: =450
            X: =98
            Y: =500
      - HTML_Aguardando_Dialogo_3:
          Control: HtmlViewer@2.1.0
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Font: =Font.'Open Sans'
            Height: =50
            HtmlText: |-
              =//"Exiba seu texto <b><font color=blue>HTML</font></b> aqui."
              "Fora do prazo: <b>" & ForaPrazo
            Width: =450
            X: =98
            Y: =550
      - HTML_Aguardando_Dialogo_4:
          Control: HtmlViewer@2.1.0
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Font: =Font.'Open Sans'
            Height: =50
            HtmlText: |-
              =//"Exiba seu texto <b><font color=blue>HTML</font></b> aqui."
              "Só Entrevista: <b>" & SoEntrevista
            Width: =450
            X: =95
            Y: =250
      - HTML_Aguardando_Dialogo_5:
          Control: HtmlViewer@2.1.0
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Font: =Font.'Open Sans'
            Height: =50
            HtmlText: |-
              =//"Exiba seu texto <b><font color=blue>HTML</font></b> aqui."
              "Só 1a. Semana: <b>" & So1aSemana
            Width: =450
            X: =98
            Y: =300
      - HTML_Aguardando_Dialogo_6:
          Control: HtmlViewer@2.1.0
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Font: =Font.'Open Sans'
            Height: =50
            HtmlText: |-
              =//"Exiba seu texto <b><font color=blue>HTML</font></b> aqui."
              "Só 2a. Semana: <b>" & So2aSemana
            Width: =450
            X: =98
            Y: =350
      - HTML_Aguardando_Dialogo_7:
          Control: HtmlViewer@2.1.0
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Font: =Font.'Open Sans'
            Height: =50
            HtmlText: |-
              =//"Exiba seu texto <b><font color=blue>HTML</font></b> aqui."
              "Só 3a. Semana: <b>" & So3aSemana
            Width: =450
            X: =98
            Y: =400
