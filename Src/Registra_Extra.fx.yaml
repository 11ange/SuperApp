"Registra_Extra As screen.'phoneDetailEditLayout_ver3.0'":
    Fill: =RGBA(232, 232, 232, 1)
    OnVisible: =false

    RectQuickActionBar3_12 As rectangle:
        BorderColor: =RGBA(0, 89, 178, 1)
        Fill: =RGBA(0, 51, 102, 1)
        Height: =88
        Width: =Parent.Width
        ZIndex: =1

    Icone_Cancela_Controle_3 As icon.Cancel:
        AccessibleLabel: =Self.Tooltip
        BorderColor: =RGBA(0, 89, 178, 1)
        Color: =RGBA(255, 255, 255, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(244, 244, 244, 1)
        Height: =88
        Icon: =Icon.Cancel
        OnSelect: =Back()
        PaddingBottom: =22
        PaddingLeft: =22
        PaddingRight: =22
        PaddingTop: =22
        PressedFill: =RGBA(255, 255, 255, 0.3)
        TabIndex: =0
        Tooltip: ="Cancel item"
        Width: =88
        ZIndex: =2

    Icone_Salva_Controle_1 As icon.Check:
        AccessibleLabel: =Self.Tooltip
        BorderColor: =RGBA(0, 89, 178, 1)
        Color: =RGBA(255, 255, 255, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(244, 244, 244, 1)
        Height: =88
        Icon: =Icon.Save
        OnSelect: =
        PaddingBottom: =22
        PaddingLeft: =22
        PaddingRight: =22
        PaddingTop: =22
        PressedFill: =RGBA(255, 255, 255, 0.3)
        TabIndex: =0
        Tooltip: ="Submit item"
        Visible: =false
        Width: =88
        X: =Parent.Width - Self.Width
        ZIndex: =3

    LblAppName3_6 As label:
        Color: =RGBA(255, 255, 255, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Fill: =RGBA(58, 58, 58, 0)
        Height: =88
        Size: =27
        Text: ="Registra Extra"
        Width: =Parent.Width - Icone_Cancela_Controle_3.Width - Icone_Salva_Controle_1.Width
        Wrap: =false
        X: =80
        ZIndex: =4

    Btn_Registra_Excedente_A1 As button:
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(0, 51, 102, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        FontWeight: =FontWeight.Semibold
        Height: =80
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(0, 51, 102, 1), -20%)
        OnSelect: |-
            =UpdateContext({AssistenciaExtra: "A1", PopupConfirmaExcedente: true});
        Size: =24
        Text: ="A1"
        Width: =250
        X: =50
        Y: =400
        ZIndex: =5

    Label4 As label:
        Align: =Align.Center
        BorderColor: =RGBA(0, 89, 178, 1)
        Color: =RGBA(0, 0, 0, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FontWeight: =FontWeight.Semibold
        Height: =120
        Size: =27
        Text: ="Para qual assistência deseja confirmar a presença extra?"
        Width: =500
        X: =(Parent.Width - Self.Width) / 2
        Y: =200
        ZIndex: =6

    Btn_Registra_Excedente_A2 As button:
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(0, 51, 102, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        FontWeight: =FontWeight.Semibold
        Height: =80
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(0, 51, 102, 1), -20%)
        OnSelect: |-
            =UpdateContext({AssistenciaExtra: "A2", PopupConfirmaExcedente: true});
        Size: =24
        Text: ="A2"
        Width: =250
        X: =50
        Y: =Btn_Registra_Excedente_A1.Y + Btn_Registra_Excedente_A1.Height + 30
        ZIndex: =7

    Btn_Registra_Excedente_A3 As button:
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(0, 51, 102, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        FontWeight: =FontWeight.Semibold
        Height: =80
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(0, 51, 102, 1), -20%)
        OnSelect: |-
            =UpdateContext({AssistenciaExtra: "A3", PopupConfirmaExcedente: true});
        Size: =24
        Text: ="A3"
        Width: =250
        X: =50
        Y: =Btn_Registra_Excedente_A2.Y + Btn_Registra_Excedente_A2.Height + 30
        ZIndex: =8

    Btn_Registra_Excedente_C1 As button:
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(0, 51, 102, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        FontWeight: =FontWeight.Semibold
        Height: =80
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(0, 51, 102, 1), -20%)
        OnSelect: |-
            =UpdateContext({AssistenciaExtra: "C1", PopupConfirmaExcedente: true});
        Size: =24
        Text: ="C1"
        Width: =250
        X: =Parent.Width - Self.Width - 50
        Y: =Btn_Registra_Excedente_A1.Y
        ZIndex: =9

    Btn_Registra_Excedente_C2 As button:
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(0, 51, 102, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        FontWeight: =FontWeight.Semibold
        Height: =80
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(0, 51, 102, 1), -20%)
        OnSelect: |-
            =UpdateContext({AssistenciaExtra: "C2", PopupConfirmaExcedente: true});
        Size: =24
        Text: ="C2"
        Width: =250
        X: =Parent.Width - Self.Width - 50
        Y: |-
            =Btn_Registra_Excedente_A2
            .Y
        ZIndex: =10

    Btn_Registra_Excedente_C3 As button:
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(0, 51, 102, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        FontWeight: =FontWeight.Semibold
        Height: =80
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(0, 51, 102, 1), -20%)
        OnSelect: |-
            =UpdateContext({AssistenciaExtra: "C3", PopupConfirmaExcedente: true});
        Size: =24
        Text: ="C3"
        Width: =250
        X: =Parent.Width - Self.Width - 50
        Y: |
            =Btn_Registra_Excedente_A3.Y
        ZIndex: =11

    Fundo_Popup_1 As rectangle:
        BorderColor: =RGBA(0, 89, 178, 1)
        Fill: =RGBA(100, 118, 132, 0.6)
        Height: =Parent.Height - RectQuickActionBar3_12.Height
        Visible: =PopupConfirmaExcedente//MostraPopUp Or PopupConfirmaEnvioDialogo Or PopupConfirmaExcedente //Or PopupDialogoSemanaQueVem
        Width: =Parent.Width
        Y: =88
        ZIndex: =12

    Popup_Confirma_Excedente_2 As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =35

        Retangulo_Popup_Confirma_Excedente As rectangle:
            BorderColor: =RGBA(0, 89, 178, 1)
            Fill: =Color.White
            Height: =281
            Visible: =PopupConfirmaExcedente
            Width: =464
            X: =Parent.Width/2 - Self.Width/2
            Y: =428
            ZIndex: =13

        Btn_Nao_Confirma_Excedente_2 As button:
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(0, 51, 102, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            FontWeight: =FontWeight.Semibold
            Height: =55
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(0, 51, 102, 1), -20%)
            OnSelect: |-
                =UpdateContext({PopupConfirmaExcedente: false});
            Size: =24
            Text: ="Não"
            Visible: =PopupConfirmaExcedente
            Width: =157
            X: =Retangulo_Popup_Confirma_Excedente.X + (Retangulo_Popup_Confirma_Excedente.Width/4) - Self.Width/2
            Y: =630
            ZIndex: =14

        Btn_Sim_Confirma_Excedente_2 As button:
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(0, 51, 102, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            FontWeight: =FontWeight.Semibold
            Height: =55
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(0, 51, 102, 1), -20%)
            OnSelect: |-
                =
                //------------------------------------------------------------------------------------------
                // Registra na tabela Presenças_Excedentes um excedente na data atual e na assistência
                // Verificar se a data atual já existe na tabela Presenças_Excedentes
                //------------------------------------------------------------------------------------------
                // Registra na tabela Presenças_Excedentes um excedente na data atual e na assistência
                // Verificar se a data atual já existe na tabela Presenças_Excedentes
                Set(Hoje, Text(Today(), "[$-pt-BR]dd/mm/yyyy"));
                
                Set(ExistingRecord, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo));
                
                // Se não existir, criar um novo registro
                If(
                    IsBlank(ExistingRecord),
                    Patch(Excedentes, Defaults(Excedentes), {Data: Hoje, PeriodoDia: Periodo})
                );
                
                If(
                    AssistenciaExtra = "A1",
                    Patch(Excedentes, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo), 
                            {A1: If(IsBlank(LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).A1), 1, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).A1 + 1)}),
                    AssistenciaExtra = "A2",
                    Patch(Excedentes, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo), 
                            {A2: If(IsBlank(LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).A2), 1, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).A2 + 1)}),
                    AssistenciaExtra = "A3",
                    Patch(Excedentes, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo), 
                            {A3: If(IsBlank(LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).A3), 1, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).A3 + 1)}),
                    AssistenciaExtra = "C1",
                    Patch(Excedentes, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo), 
                            {C1: If(IsBlank(LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).C1), 1, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).C1 + 1)}),
                    AssistenciaExtra = "C2",
                    Patch(Excedentes, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo), 
                            {C2: If(IsBlank(LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).C2), 1, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).C2 + 1)}),
                    AssistenciaExtra = "C3",
                    Patch(Excedentes, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo), 
                            {C3: If(IsBlank(LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).C3), 1, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).C3 + 1)}),
                    AssistenciaExtra = "A3/A1",
                    Patch(Excedentes, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo), 
                            {A3: If(IsBlank(LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).A3), 1, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).A3 + 1),
                             A1: If(IsBlank(LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).A1), 1, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).A1 + 1)}),
                    AssistenciaExtra = "C3/C1",
                    Patch(Excedentes, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo), 
                            {C3: If(IsBlank(LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).C3), 1, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).C3 + 1),
                             C1: If(IsBlank(LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).C1), 1, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).C1 + 1)}),
                    AssistenciaExtra = "A3/A2",
                    Patch(Excedentes, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo), 
                            {A3: If(IsBlank(LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).A3), 1, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).A3 + 1),
                             A2: If(IsBlank(LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).A2), 1, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).A2 + 1)}),
                    AssistenciaExtra = "C3/C2",
                    Patch(Excedentes, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo), 
                            {C3: If(IsBlank(LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).C3), 1, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).C3 + 1),
                             C2: If(IsBlank(LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).C2), 1, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).C2 + 1)}),
                    AssistenciaExtra = "A3/A2-Casa",
                    Patch(Excedentes, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo), 
                            {A3: If(IsBlank(LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).A3), 1, LookUp(Excedentes, Data = Hoje && PeriodoDia = Periodo).A3 + 1)})
                );
                //------------------------------------------------------------------------------------------
                
                UpdateContext({PopupConfirmaExcedente: false});
                
                Back();
            Size: =24
            Text: ="Sim"
            Visible: =PopupConfirmaExcedente
            Width: =157
            X: =Retangulo_Popup_Confirma_Excedente.X + (Retangulo_Popup_Confirma_Excedente.Width/4)*3 - Self.Width/2
            Y: =630
            ZIndex: =15

        lbl_Texto_popup_Confirma_Envio_Dialogo_4 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 89, 178, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Height: =84
            Size: =21
            Text: ="Deseja confirmar Excedente para hoje?"
            Visible: =PopupConfirmaExcedente
            Width: =464
            X: =Retangulo_Popup_Confirma_Excedente.X
            Y: =505
            ZIndex: =16

        lbl_Aviso_popup_Confirma_Envio_Dialogo_4 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 89, 178, 1)
            Color: =RGBA(255, 255, 255, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Fill: =Color.Red
            FontWeight: =FontWeight.Bold
            Height: =72
            Size: =21
            Text: ="Aviso"
            Visible: =PopupConfirmaExcedente
            Width: =464
            X: =Retangulo_Popup_Confirma_Excedente.X
            Y: =428
            ZIndex: =17

