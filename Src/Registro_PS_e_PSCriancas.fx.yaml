Registro_PS_e_PSCriancas As screen:
    Fill: =RGBA(232, 232, 232, 1)
    OnVisible: |-
        =Refresh(Presenças);
        
        Reset(txt_PS);
        Reset(txt_PSC);
        
        UpdateContext(
            {
                Atual_PS:  0,
                Atual_PSC: 0,
                Mostra_PSC: false
            }
        );
        
        Select(btn_HelperAtualizaPS);
        
        /*
        If(
            !IsBlank(diaSelecionado),
            With(
                {
                    valorPS:
                        If(
                            IsBlank(txt_PS.Text),
                            diaSelecionado.PS,
                            Value(txt_PS.Text)
                        ),
        
                    valorPSC:
                        If(
                            Mostra_PSC,
                            If(
                                IsBlank(txt_PSC.Text),
                                diaSelecionado.'PS Crianças',
                                Value(txt_PSC.Text)
                            ),
                            diaSelecionado.'PS Crianças'
                        )
                },
        
                Patch(
                    Presenças,
                    diaSelecionado,
                    {
                        PS: valorPS,
                        'PS Crianças': valorPSC
                    }
                )
            )
        );
        
        Refresh(Presenças);
        
        With(
            {
                dataInicial: Data_Inicial_1.SelectedDate,
                periodoSelecionado: Dropdown_Periodo_2.Selected.Value,
                isQuintaFeira: Weekday(Data_Inicial_1.SelectedDate) = 5
            },
        
            If(
                Weekday(Data_Inicial_1.SelectedDate) = 5,
        
                // SE FOR QUINTA-FEIRA: Execute o LookUp com o filtro de período
                UpdateContext({
                    diaSelecionado: LookUp(
                        Presenças,
                        Data = Text(Data_Inicial_1.SelectedDate, "dd/mm/yyyy") &&
                        PeriodoDia = Dropdown_Periodo_2.Selected.Value
                    )
                }),
        
                // SE NÃO FOR QUINTA-FEIRA: Execute o LookUp SÓ com o filtro de data
                UpdateContext({
                    diaSelecionado: LookUp(
                        Presenças,
                        Data = Text(Data_Inicial_1.SelectedDate, "dd/mm/yyyy")
                    )
                })
            );
        
            UpdateContext({
                Atual_PS: diaSelecionado.PS,
                Atual_PSC: diaSelecionado.'PS Crianças',
                Mostra_PSC:
                    Or(
                        Weekday(dataInicial) = 4, // Quarta
                        Weekday(dataInicial) = 7, // Sábado
                        Weekday(dataInicial) = 1, // Domingo
                        And(
                            Weekday(dataInicial) = 5, // Quinta
                            periodoSelecionado = "Tarde"
                        )
                    )
            });
            
        );*/

    RectQuickActionBar3_13 As rectangle:
        BorderColor: =RGBA(0, 89, 178, 1)
        Fill: =RGBA(0, 51, 102, 1)
        Height: =88
        Width: =Parent.Width
        ZIndex: =2

    Icone_Cancela_Controle_4 As icon.Cancel:
        AccessibleLabel: =Self.Tooltip
        BorderColor: =RGBA(0, 89, 178, 1)
        Color: =RGBA(255, 255, 255, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(244, 244, 244, 1)
        Height: =88
        Icon: =Icon.CancelBadge
        OnSelect: =Back()
        PaddingBottom: =22
        PaddingLeft: =22
        PaddingRight: =22
        PaddingTop: =22
        PressedFill: =RGBA(255, 255, 255, 0.3)
        TabIndex: =0
        Tooltip: ="Cancel item"
        Width: =88
        ZIndex: =3

    LblAppName3_7 As label:
        Color: =RGBA(255, 255, 255, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Fill: =RGBA(58, 58, 58, 0)
        Height: =88
        Size: =27
        Text: ="Totais de Passes Simples"
        Width: =Parent.Width - Icone_Cancela_Controle_4.Width
        Wrap: =false
        X: =80
        ZIndex: =4

    lbl_Data_Inicial_1 As label:
        Align: =Align.Center
        BorderColor: =RGBA(0, 89, 178, 1)
        Color: =RGBA(0, 0, 0, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Height: =50
        Size: =21
        Text: ="Data"
        Visible: =false
        Width: =180
        X: =App.MinScreenWidth/4 - Self.Width/2 - 20
        Y: =100
        ZIndex: =5

    Data_Inicial_1 As datepicker:
        BorderColor: =RGBA(0, 89, 178, 1)
        CalendarHeaderFill: =RGBA(0, 51, 102, 1)
        Color: =RGBA(0, 0, 0, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Height: =70
        HoverDateFill: =RGBA(153, 205, 255, 1)
        IconBackground: =RGBA(0, 51, 102, 1)
        OnChange: |-
            =Reset(txt_PS);
            Reset(txt_PSC);
            
            Select(btn_HelperAtualizaPS)
            /*
            If(
                !IsBlank(diaSelecionado),
                With(
                    {
                        valorPS:
                            If(
                                IsBlank(txt_PS.Text),
                                diaSelecionado.PS,
                                Value(txt_PS.Text)
                            ),
            
                        valorPSC:
                            If(
                                Mostra_PSC,
                                If(
                                    IsBlank(txt_PSC.Text),
                                    diaSelecionado.'PS Crianças',
                                    Value(txt_PSC.Text)
                                ),
                                diaSelecionado.'PS Crianças'
                            )
                    },
            
                    Patch(
                        Presenças,
                        diaSelecionado,
                        {
                            PS: valorPS,
                            'PS Crianças': valorPSC
                        }
                    )
                )
            );
            
            Refresh(Presenças);
            
            With(
                {
                    dataInicial: Data_Inicial_1.SelectedDate,
                    periodoSelecionado: Dropdown_Periodo_2.Selected.Value,
                    isQuintaFeira: Weekday(Data_Inicial_1.SelectedDate) = 5
                },
            
                If(
                    Weekday(Data_Inicial_1.SelectedDate) = 5,
            
                    // SE FOR QUINTA-FEIRA: Execute o LookUp com o filtro de período
                    UpdateContext({
                        diaSelecionado: LookUp(
                            Presenças,
                            Data = Text(Data_Inicial_1.SelectedDate, "dd/mm/yyyy") &&
                            PeriodoDia = Dropdown_Periodo_2.Selected.Value
                        )
                    }),
            
                    // SE NÃO FOR QUINTA-FEIRA: Execute o LookUp SÓ com o filtro de data
                    UpdateContext({
                        diaSelecionado: LookUp(
                            Presenças,
                            Data = Text(Data_Inicial_1.SelectedDate, "dd/mm/yyyy")
                        )
                    })
                );
            
                UpdateContext({
                    Atual_PS: diaSelecionado.PS,
                    Atual_PSC: diaSelecionado.'PS Crianças',
                    Mostra_PSC:
                        Or(
                            Weekday(dataInicial) = 4, // Quarta
                            Weekday(dataInicial) = 7, // Sábado
                            Weekday(dataInicial) = 1, // Domingo
                            And(
                                Weekday(dataInicial) = 5, // Quinta
                                periodoSelecionado = "Tarde"
                            )
                        )
                });
                
            );*/
        SelectedDateFill: =RGBA(0, 51, 102, 1)
        Size: =24
        Width: =250
        X: =(Parent.Width - Self.Width) / 2
        Y: =RectQuickActionBar3_13.X + RectQuickActionBar3_13.Height + 60
        ZIndex: =6

    Dropdown_Periodo_2 As dropdown:
        BorderColor: =RGBA(0, 89, 178, 1)
        ChevronBackground: =RGBA(0, 51, 102, 1)
        ChevronDisabledBackground: =RGBA(166, 166, 166, 1)
        ChevronDisabledFill: =RGBA(244, 244, 244, 1)
        ChevronHoverBackground: =ColorFade(RGBA(0, 51, 102, 1), -20%)
        ChevronHoverFill: =RGBA(255, 255, 255, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Height: =50
        HoverColor: =RGBA(0, 0, 0, 1)
        HoverFill: =RGBA(153, 205, 255, 1)
        Items: =["Tarde", "Noite"]
        OnChange: |-
            =Refresh(Presenças);
            
            With(
                {
                    dataInicial: Data_Inicial_1.SelectedDate,
                    periodoSelecionado: Dropdown_Periodo_2.Selected.Value,
                    isQuintaFeira: Weekday(Data_Inicial_1.SelectedDate) = 5
                },
            
                If(
                    Weekday(Data_Inicial_1.SelectedDate) = 5,
            
                    // SE FOR QUINTA-FEIRA: Execute o LookUp com o filtro de período
                    UpdateContext({
                        diaSelecionado: LookUp(
                            Presenças,
                            Data = Text(Data_Inicial_1.SelectedDate, "dd/mm/yyyy") &&
                            PeriodoDia = Dropdown_Periodo_2.Selected.Value
                        )
                    }),
            
                    // SE NÃO FOR QUINTA-FEIRA: Execute o LookUp SÓ com o filtro de data
                    UpdateContext({
                        diaSelecionado: LookUp(
                            Presenças,
                            Data = Text(Data_Inicial_1.SelectedDate, "dd/mm/yyyy")
                        )
                    })
                );
            
                UpdateContext({
                    Atual_PS: diaSelecionado.PS,
                    Atual_PSC: diaSelecionado.'PS Crianças',
                    Mostra_PSC:
                        Or(
                            Weekday(dataInicial) = 4, // Quarta
                            Weekday(dataInicial) = 7, // Sábado
                            Weekday(dataInicial) = 1, // Domingo
                            And(
                                Weekday(dataInicial) = 5, // Quinta
                                periodoSelecionado = "Tarde"
                            )
                        )
                });
            );
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(0, 89, 178, 1)
        SelectionFill: =RGBA(0, 51, 102, 1)
        Size: =21
        Visible: =(Weekday(Data_Inicial_1.SelectedDate) = 5) //true
        Width: =300
        X: =(Parent.Width - Self.Width) / 2
        Y: =Data_Inicial_1.Y + Data_Inicial_1.Height + 30
        ZIndex: =7

    btn_Enviar As button:
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(0, 51, 102, 1)
        FontWeight: =FontWeight.Semibold
        Height: =70
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(0, 51, 102, 1), -20%)
        OnSelect: =Select(btn_HelperAtualizaPS)
        Size: =24
        Text: ="Gravar Valores"
        Width: =280
        X: =(Parent.Width - Self.Width) / 2
        Y: =txt_PSC.Y + txt_PSC.Height + 100
        ZIndex: =8

    txt_PS As text:
        BorderColor: =RGBA(0, 89, 178, 1)
        BorderThickness: =2
        Color: =RGBA(0, 0, 0, 1)
        Default: =
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        FocusedBorderThickness: =4
        Format: =TextFormat.Number
        Height: =70
        HintText: ="PS"
        HoverBorderColor: =RGBA(0, 89, 178, 1)
        HoverColor: =RGBA(0, 0, 0, 1)
        HoverFill: =RGBA(153, 205, 255, 1)
        Size: =21
        Width: =180
        X: =320
        Y: =lbl_Explicacao.Y + lbl_Explicacao.Height + 100
        ZIndex: =9

    txt_PSC As text:
        BorderColor: =RGBA(0, 89, 178, 1)
        BorderThickness: =2
        Color: =RGBA(0, 0, 0, 1)
        Default: =
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        FocusedBorderThickness: =4
        Format: =TextFormat.Number
        Height: =70
        HintText: ="PS Crianças"
        HoverBorderColor: =RGBA(0, 89, 178, 1)
        HoverColor: =RGBA(0, 0, 0, 1)
        HoverFill: =RGBA(153, 205, 255, 1)
        Size: =21
        Visible: =Mostra_PSC
        Width: =180
        X: =txt_PS.X
        Y: =txt_PS.Y + txt_PS.Height + 50
        ZIndex: =10

    lbl_Explicacao As label:
        Align: =Align.Center
        BorderColor: =RGBA(0, 89, 178, 1)
        Color: =RGBA(0, 0, 0, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FontWeight: =FontWeight.Bold
        Height: =100
        Size: =27
        Text: ="Digite somente os valores de passes de assistidos"
        Width: =550
        X: =(Parent.Width - Self.Width) / 2
        Y: =Dropdown_Periodo_2.Y + Dropdown_Periodo_2.Height + 30
        ZIndex: =11

    lbl_PS As label:
        BorderColor: =RGBA(0, 89, 178, 1)
        Color: =RGBA(0, 0, 0, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Height: =70
        Size: =21
        Text: ="PS"
        Width: =180
        X: =20
        Y: =txt_PS.Y
        ZIndex: =12

    lbl_PSC As label:
        BorderColor: =RGBA(0, 89, 178, 1)
        Color: =RGBA(0, 0, 0, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Height: =70
        Size: =21
        Text: ="PS Crianças"
        Visible: =Mostra_PSC
        Width: =180
        X: =20
        Y: =txt_PSC.Y
        ZIndex: =13

    lbl_Atual_Novo As label:
        BorderColor: =RGBA(0, 89, 178, 1)
        Color: =RGBA(0, 0, 0, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Height: =70
        Size: =21
        Text: ="Atual           Novo"
        Width: =300
        X: =220
        Y: =lbl_Explicacao.Y + lbl_Explicacao.Height + 30
        ZIndex: =15

    lbl_Atual_PS As label:
        Align: =Align.Right
        BorderColor: =RGBA(0, 89, 178, 1)
        Color: =RGBA(0, 0, 0, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Height: =70
        Size: =21
        Text: =Atual_PS
        Width: =70
        X: =220
        Y: =txt_PS.Y
        ZIndex: =16

    lbl_Atual_PSC As label:
        Align: =Align.Right
        BorderColor: =RGBA(0, 89, 178, 1)
        Color: =RGBA(0, 0, 0, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Height: =70
        Size: =21
        Text: =Atual_PSC
        Visible: =Mostra_PSC
        Width: =70
        X: =lbl_Atual_PS.X
        Y: =txt_PSC.Y
        ZIndex: =17

    btn_HelperAtualizaPS As button:
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(0, 51, 102, 1)
        FontWeight: =FontWeight.Semibold
        Height: =70
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(0, 51, 102, 1), -20%)
        OnSelect: |-
            =If(
                !IsBlank(diaSelecionado),
                With(
                    {
                        valorPS:
                            If(
                                IsBlank(txt_PS.Text),
                                diaSelecionado.PS,
                                Value(txt_PS.Text)
                            ),
            
                        valorPSC:
                            If(
                                Mostra_PSC,
                                If(
                                    IsBlank(txt_PSC.Text),
                                    diaSelecionado.'PS Crianças',
                                    Value(txt_PSC.Text)
                                ),
                                diaSelecionado.'PS Crianças'
                            )
                    },
            
                    Patch(
                        Presenças,
                        diaSelecionado,
                        {
                            PS: valorPS,
                            'PS Crianças': valorPSC
                        }
                    )
                )
            );
            
            Refresh(Presenças);
            
            With(
                {
                    dataInicial: Data_Inicial_1.SelectedDate,
                    periodoSelecionado: Dropdown_Periodo_2.Selected.Value,
                    isQuintaFeira: Weekday(Data_Inicial_1.SelectedDate) = 5
                },
            
                If(
                    Weekday(Data_Inicial_1.SelectedDate) = 5,
            
                    // SE FOR QUINTA-FEIRA: Execute o LookUp com o filtro de período
                    UpdateContext({
                        diaSelecionado: LookUp(
                            Presenças,
                            Data = Text(Data_Inicial_1.SelectedDate, "dd/mm/yyyy") &&
                            PeriodoDia = Dropdown_Periodo_2.Selected.Value
                        )
                    }),
            
                    // SE NÃO FOR QUINTA-FEIRA: Execute o LookUp SÓ com o filtro de data
                    UpdateContext({
                        diaSelecionado: LookUp(
                            Presenças,
                            Data = Text(Data_Inicial_1.SelectedDate, "dd/mm/yyyy")
                        )
                    })
                );
            
                UpdateContext({
                    Atual_PS: diaSelecionado.PS,
                    Atual_PSC: diaSelecionado.'PS Crianças',
                    Mostra_PSC:
                        Or(
                            Weekday(dataInicial) = 4, // Quarta
                            Weekday(dataInicial) = 7, // Sábado
                            Weekday(dataInicial) = 1, // Domingo
                            And(
                                Weekday(dataInicial) = 5, // Quinta
                                periodoSelecionado = "Tarde"
                            )
                        )
                });
                
            );
        Size: =24
        Text: ="Button"
        Width: =280
        X: =440
        Y: =1376
        ZIndex: =18

