"Corrige_Dialogo As screen.'phoneDetailViewLayout_ver3.0'":
    Fill: =RGBA(232, 232, 232, 1)
    OnVisible: |-
        =UpdateContext({MostraPopUp: false});
        UpdateContext(
            {
                Tarefeiro: Dropdown_Tarefeiro.Selected.Value,
                ID_A_Corrigir: Blank(),
                Data_Dialogo: Today()
            }
        );

    Lbl_Titulo_7 As label:
        BorderColor: =RGBA(0, 89, 178, 1)
        Color: =RGBA(241, 244, 249, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Fill: =RGBA(0, 18, 107, 1)
        Height: =88
        Italic: =true
        Size: =27
        Text: ="Correção de Dialogo"
        Width: =Parent.Width - Self.X
        X: =80
        ZIndex: =1

    Icone_Voltar_Assistidos_5 As icon.ChevronLeft:
        AccessibleLabel: =Self.Tooltip
        BorderColor: =RGBA(0, 89, 178, 1)
        Color: =RGBA(255, 255, 255, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(0, 18, 107, 1)
        Height: =88
        Icon: =Icon.BackArrow
        OnSelect: =Navigate(Principal, ScreenTransition.CoverRight)
        PaddingBottom: =24
        PaddingLeft: =24
        PaddingRight: =24
        PaddingTop: =24
        PressedFill: =RGBA(255, 255, 255, 0.3)
        TabIndex: =0
        Tooltip: ="Back to list"
        Width: =88
        ZIndex: =2

    Lbl_Usuario_Logado_7 As label:
        BorderColor: =RGBA(0, 89, 178, 1)
        Color: =RGBA(241, 244, 249, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Fill: =RGBA(0, 18, 107, 1)
        FontWeight: =FontWeight.Bold
        Height: =88
        Italic: =true
        Size: =28
        Text: =Concatenate("   ",Usuario_Logado," - ",Perfil_Logado)
        Width: =Parent.Width
        Y: =Parent.Height-Self.Height
        ZIndex: =3

    Lbl_IDAssistido As label:
        Align: =Align.Center
        BorderColor: =RGBA(0, 89, 178, 1)
        Color: =RGBA(0, 0, 0, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Height: =60
        Size: =27
        Text: |-
            ="Selecione o ID do Assistido:"
        Width: =550
        X: =(Parent.Width - Self.Width) / 2 
        Y: =Date_Dialogo.Y + Date_Dialogo.Height + 40
        ZIndex: =4

    Dropdown_Tarefeiro As dropdown:
        BorderColor: =RGBA(0, 89, 178, 1)
        ChevronBackground: =RGBA(0, 51, 102, 1)
        ChevronDisabledBackground: =RGBA(166, 166, 166, 1)
        ChevronDisabledFill: =RGBA(244, 244, 244, 1)
        ChevronHoverBackground: =ColorFade(RGBA(0, 51, 102, 1), -20%)
        ChevronHoverFill: =RGBA(255, 255, 255, 1)
        Default: ="0"
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Height: =60
        HoverColor: =RGBA(0, 0, 0, 1)
        HoverFill: =RGBA(153, 205, 255, 1)
        Items: |-
            =SortByColumns( 
                Distinct( 
                    Filter( 
                        Pessoas, 
                        'ID Pessoa' in  
                        Distinct( 
                            Filter(Alocações, Aloc_Tarefa = 24), 
                            Aloc_Pessoa 
                        ).Value 
                    ), 
                    'Nome Pessoa' 
                ), 
                "Value", // Ou "Result"
                SortOrder.Ascending 
            )
        OnChange: |-
            =//false
            UpdateContext({Tarefeiro: Dropdown_Tarefeiro.Selected.Value});
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(0, 89, 178, 1)
        SelectionFill: =RGBA(0, 51, 102, 1)
        Size: =24
        Width: =550
        X: =(Parent.Width - Self.Width) / 2
        Y: =lbl_Tarefeiro_Correto.Y + lbl_Tarefeiro_Correto.Height + 20
        ZIndex: =5

    Btn_Registra_Orientação_1 As button:
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(0, 51, 102, 1)
        FontWeight: =FontWeight.Semibold
        Height: =85
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(0, 51, 102, 1), -20%)
        OnSelect: |
            =//false
            UpdateContext({MostraPopUp: true})
        Size: =27
        Text: ="Confirma"
        Width: =280
        X: =(Parent.Width - Self.Width) / 2
        Y: =Dropdown_Tarefeiro.Y + Dropdown_Tarefeiro.Height + 50 
        ZIndex: =6

    Fundo_Popup_4 As rectangle:
        BorderColor: =RGBA(0, 89, 178, 1)
        Fill: =RGBA(100, 118, 132, 0.6)
        Height: =Parent.Height - Lbl_Titulo_7.Height
        Visible: =MostraPopUp
        Width: =Parent.Width
        Y: =88
        ZIndex: =7

    lbl_Tarefeiro_Correto As label:
        Align: =Align.Center
        BorderColor: =RGBA(0, 89, 178, 1)
        Color: =RGBA(0, 0, 0, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Height: =60
        Size: =27
        Text: |-
            ="Selecione o Tarefeiro Correto:"
        Width: =550
        X: =(Parent.Width - Self.Width) / 2 
        Y: =HtmlEntrevista.Y + HtmlEntrevista.Height + 20
        ZIndex: =8

    lbl_Data_Dialogo As label:
        Align: =Align.Center
        BorderColor: =RGBA(0, 89, 178, 1)
        Color: =RGBA(0, 0, 0, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Height: =60
        Size: =27
        Text: |-
            ="Escolha a data do Diálogo:"
        Width: =550
        X: =(Parent.Width - Self.Width) / 2 
        Y: =90
        ZIndex: =9

    Date_Dialogo As datepicker:
        BorderColor: =RGBA(0, 89, 178, 1)
        CalendarHeaderFill: =RGBA(0, 51, 102, 1)
        Color: =RGBA(0, 0, 0, 1)
        DefaultDate: =Today()-2
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Height: =60
        HoverDateFill: =RGBA(153, 205, 255, 1)
        IconBackground: =RGBA(0, 51, 102, 1)
        OnChange: |-
            =UpdateContext({Data_Dialogo: Date_Dialogo.SelectedDate});
            UpdateContext(
                {
                    ID_A_Corrigir: Drop_ID_a_Corrigir.SelectedText,
                    Entrevista: LookUp(
                        Assistências,
                        // Filtro de data delegável
                        'Data Entrevista' >= Date_Dialogo.SelectedDate &&
                        'Data Entrevista' < DateAdd(Date_Dialogo.SelectedDate, 1, TimeUnit.Days) &&
                        // Filtro de ID que já era delegável
                        'ID Pessoa' = Drop_ID_a_Corrigir.Selected.Value
                    ).Entrevistador,
                    Dialogo: LookUp(
                        Assistências_Encerradas,
                        // Filtro de data delegável
                        'Data Diálogo' >= Date_Dialogo.SelectedDate &&
                        'Data Diálogo' < DateAdd(Date_Dialogo.SelectedDate, 1, TimeUnit.Days) &&
                         // Filtro de ID que já era delegável
                        'ID Pessoa' = Drop_ID_a_Corrigir.Selected.Value
                    ).Dialogador
                }
            )
        SelectedDateFill: =RGBA(0, 51, 102, 1)
        Size: =24
        Width: =300
        X: =(Parent.Width - Self.Width) / 2 
        Y: =lbl_Data_Dialogo.Y + lbl_Data_Dialogo.Height + 20
        ZIndex: =10

    Drop_ID_a_Corrigir As dropdown:
        BorderColor: =RGBA(0, 89, 178, 1)
        ChevronBackground: =RGBA(0, 51, 102, 1)
        ChevronDisabledBackground: =RGBA(166, 166, 166, 1)
        ChevronDisabledFill: =RGBA(244, 244, 244, 1)
        ChevronHoverBackground: =ColorFade(RGBA(0, 51, 102, 1), -20%)
        ChevronHoverFill: =RGBA(255, 255, 255, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Height: =60
        HoverColor: =RGBA(0, 0, 0, 1)
        HoverFill: =RGBA(153, 205, 255, 1)
        Items: |-
            =Sort(
                Distinct(
                    Filter(
                        Assistências_Encerradas,
                        // --- INÍCIO DA CORREÇÃO ---
                        // Compara a coluna de data/hora diretamente, sem usar a função Text()
                        'Data Diálogo' >= Date_Dialogo.SelectedDate &&
                        'Data Diálogo' < DateAdd(Date_Dialogo.SelectedDate, 1, TimeUnit.Days)
                        // --- FIM DA CORREÇÃO ---
                    ),
                    'ID Pessoa'
                ),
                // A função Distinct retorna uma tabela com uma única coluna chamada "Result"
                Value,
                SortOrder.Ascending
            )
        OnChange: |-
            =UpdateContext(
                {
                    ID_A_Corrigir: Drop_ID_a_Corrigir.SelectedText,
            
                    Entrevista: LookUp(
                        Assistências,
                        // Filtro de data delegável
                        'Data Entrevista' >= Date_Dialogo.SelectedDate &&
                        'Data Entrevista' < DateAdd(Date_Dialogo.SelectedDate, 1, TimeUnit.Days) &&
                        // Filtro de ID que já era delegável
                        'ID Pessoa' = Drop_ID_a_Corrigir.Selected.Value
                    ).Entrevistador,
            
                    Dialogo: LookUp(
                        Assistências_Encerradas,
                        // Filtro de data delegável
                        'Data Diálogo' >= Date_Dialogo.SelectedDate &&
                        'Data Diálogo' < DateAdd(Date_Dialogo.SelectedDate, 1, TimeUnit.Days) &&
                         // Filtro de ID que já era delegável
                        'ID Pessoa' = Drop_ID_a_Corrigir.Selected.Value
                    ).Dialogador
                }
            )
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(0, 89, 178, 1)
        SelectionFill: =RGBA(0, 51, 102, 1)
        Size: =21
        Width: =180
        X: =(Parent.Width - Self.Width) / 2
        Y: =Lbl_IDAssistido.Y + Lbl_IDAssistido.Height + 20
        ZIndex: =11

    HtmlEntrevista As htmlViewer:
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        Height: =130
        HtmlText: |-
            ="<div style='text-align: center;'>
                Entrevistador: <br><b>" & Entrevista & "</b>
            </div>"
        Size: =21
        Width: =300
        X: =57
        Y: =Drop_ID_a_Corrigir.Y + Drop_ID_a_Corrigir.Height + 20
        ZIndex: =12

    HtmlDialogo As htmlViewer:
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        Height: =130
        HtmlText: |-
            ="<div style='text-align: center;'>
                Dialogador: <br><b>" & Dialogo & "</b>
            </div>"
        Size: =21
        Width: =300
        X: =372
        Y: =HtmlEntrevista.Y
        ZIndex: =13

    Popup_Confirma_Orientação_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =49

        Retangulo_Popup_Confirma_Envio_Dialogo_4 As rectangle:
            BorderColor: =RGBA(0, 89, 178, 1)
            Fill: =Color.White
            Height: =350
            Visible: =MostraPopUp
            Width: =464
            X: =Parent.Width/2 - Self.Width/2
            Y: =428
            ZIndex: =14

        lbl_Aviso_popup_Confirma_Envio_Dialogo_5 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 89, 178, 1)
            Color: =RGBA(255, 255, 255, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Fill: =Color.Red
            FontWeight: =FontWeight.Bold
            Height: =72
            Size: =21
            Text: ="Aviso"
            Visible: =MostraPopUp
            Width: =Retangulo_Popup_Confirma_Envio_Dialogo_4.Width
            X: =Parent.Width/2 - Self.Width/2
            Y: =428
            ZIndex: =15

        Btn_Sim_Confirma_Orientação_1 As button:
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(0, 51, 102, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            FontWeight: =FontWeight.Semibold
            Height: =55
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(0, 51, 102, 1), -20%)
            OnSelect: |-
                =//------------------------------------------------------------------------------------------
                // Log
                Patch(
                    Logs,
                    Defaults(Logs),
                    {
                        DataeHora: Now(),
                        DeviceID: DeviceID,
                        Ação: "Registrado Alteração de Dialogador/Entrevistador para " & ID_A_Corrigir.Value & " na data de " & Date_Dialogo.SelectedDate
                    }
                );
                //------------------------------------------------------------------------------------------
                
                UpdateContext({
                    varRegistroEncerrado: LookUp(
                        Assistências_Encerradas,
                        'Data Diálogo' >= Date_Dialogo.SelectedDate &&
                        'Data Diálogo' < DateAdd(Date_Dialogo.SelectedDate, 1, TimeUnit.Days) &&
                        'ID Pessoa' = Drop_ID_a_Corrigir.Selected.Value
                    ),
                    varRegistroAssistencias: LookUp(
                        Assistências,
                        'Data Entrevista' >= Date_Dialogo.SelectedDate &&
                        'Data Entrevista' < DateAdd(Date_Dialogo.SelectedDate, 1, TimeUnit.Days) &&
                        'ID Pessoa' = Drop_ID_a_Corrigir.Selected.Value
                    )
                });
                
                UpdateContext({
                    MostraPopUp: false,
                    
                    // Atualiza o registro e captura o novo valor do campo 'Dialogador'
                    Dialogo: Patch(
                        Assistências_Encerradas,
                        varRegistroEncerrado, // Usa a variável encontrada na Etapa 1
                        { Dialogador: Dropdown_Tarefeiro.Selected.Value }
                    ).Dialogador,
                    
                    // Atualiza o segundo registro e captura o novo valor do campo 'Entrevistador'
                    Entrevista: Patch(
                        Assistências,
                        varRegistroAssistencias, // Usa a variável encontrada na Etapa 1
                        { Entrevistador: Dropdown_Tarefeiro.Selected.Value }
                    ).Entrevistador
                });
            Size: =24
            Text: ="Sim"
            Visible: =MostraPopUp
            Width: =157
            X: =Retangulo_Popup_Confirma_Envio_Dialogo_4.X + (Retangulo_Popup_Confirma_Envio_Dialogo_4.Width/4)*3 - Self.Width/2
            Y: =710
            ZIndex: =16

        Btn_Nao_Confirma_Envio_Dialogo_2 As button:
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(0, 51, 102, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            FontWeight: =FontWeight.Semibold
            Height: =55
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(0, 51, 102, 1), -20%)
            OnSelect: |-
                =UpdateContext({MostraPopUp: false})
            Size: =24
            Text: ="Não"
            Visible: =MostraPopUp
            Width: =157
            X: =Retangulo_Popup_Confirma_Envio_Dialogo_4.X + (Retangulo_Popup_Confirma_Envio_Dialogo_4.Width/4) - Self.Width/2
            Y: =710
            ZIndex: =17

        HtmlText1_1 As htmlViewer:
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            Height: =200
            HtmlText: |-
                ="<div style='text-align: center;'>
                    Confirma Alteração do <br>ID <b>" & ID_A_Corrigir.Value & "</b><br>na data de <b>" & Data_Dialogo & "</b><br> para 
                    <b>" & Tarefeiro & " </b>
                </div>"
            Size: =21
            Visible: =MostraPopUp
            Width: =Retangulo_Popup_Confirma_Envio_Dialogo_4.Width
            X: =Parent.Width/2 - Self.Width/2
            Y: =505
            ZIndex: =18

